<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ubcc1pi: PIDStudy_module.cc Source File</title>
<link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Mono" rel="stylesheet">
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>

<header>
    ubcc1pi <br/>
    <sub>A LArSoft package for the selection and analysis of charged current single pion muon neutrino interactions in MicroBooNE</sub>
</header>

<section id="main">
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_6c72eedb3a9b729ca0d128649761b7ab.html">ubcc1pi</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_d0a27b16341ff1e3265eb16c26b5891e.html">Analyzers</a>
  </div>
</div>
<div class="contents">
<h1>PIDStudy_module.cc</h1><a href="PIDStudy__module_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**</span>
<a name="l00002"></a>00002 <span class="comment"> *  @file  ubcc1pi/Analyzers/PIDStudy_module.cc</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> *  @brief The implementation file for the PID study analyzer.</span>
<a name="l00005"></a>00005 <span class="comment"> */</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;<a class="code" href="PIDStudy_8h.html" title="The header file for the PID study analyzer.">ubcc1pi/Analyzers/PIDStudy.h</a>&quot;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;<a class="code" href="TruthHelper_8h.html" title="The header file for the truth helper class.">ubcc1pi/Helpers/TruthHelper.h</a>&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="AnalysisHelper_8h.html" title="The header file for the analysis helper class.">ubcc1pi/Helpers/AnalysisHelper.h</a>&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="RecoHelper_8h.html" title="The header file for the reco helper class.">ubcc1pi/Helpers/RecoHelper.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="DebugHelper_8h.html" title="The header file for the debug helper class.">ubcc1pi/Helpers/DebugHelper.h</a>&quot;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">namespace </span>ubcc1pi
<a name="l00016"></a>00016 {
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="classubcc1pi_1_1PIDStudy.html#aa34c45c4c357e1b50ac22b842c6bfdf9">00018</a> <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa34c45c4c357e1b50ac22b842c6bfdf9" title="Constructor.">PIDStudy::PIDStudy</a>(<span class="keyword">const</span> art::EDAnalyzer::Table&lt;Config&gt; &amp;config) :
<a name="l00019"></a>00019     art::EDAnalyzer(config),
<a name="l00020"></a>00020     m_config(config)
<a name="l00021"></a>00021 {
<a name="l00022"></a>00022     <span class="comment">// Setup the output trees</span>
<a name="l00023"></a>00023     art::ServiceHandle&lt;art::TFileService&gt; fileService;
<a name="l00024"></a>00024     
<a name="l00025"></a>00025     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a> = fileService-&gt;make&lt;TTree&gt;(<span class="stringliteral">&quot;particles&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00026"></a>00026     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;run&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a6bc123c7fb3491a9acc47eb31b540efd" title="The run number.">m_run</a>);
<a name="l00027"></a>00027     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;subRun&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa1b8e87ea34a539940d6f3ff7bfb2cb6" title="The subrun number.">m_subRun</a>);
<a name="l00028"></a>00028     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;event&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9d62271c5389b4c09caedafb401e7855" title="The event number.">m_event</a>);
<a name="l00029"></a>00029     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;isSignal&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0759361e64f5737cbaf3754a5ea2a077" title="If the event is a true CC1Pi signal.">m_isSignal</a>);
<a name="l00030"></a>00030     
<a name="l00031"></a>00031     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;nuVertex&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a00a4c0afbb17b462c59115391503f13e" title="The reconstructed neutrino vertex.">m_nuVertex</a>);
<a name="l00032"></a>00032     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;nuVertexCorrected&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a79502eb5a7d31bda894915a2389c949e" title="The SCE corrected reconstructed neutrino vertex.">m_nuVertexCorrected</a>);
<a name="l00033"></a>00033 
<a name="l00034"></a>00034     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;hasMatchedMCParticle&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa605da52b26e7200891698c4d858a5d1" title="If the PFParticle matches to any neutrino MCParticles.">m_hasMatchedMCParticle</a>);
<a name="l00035"></a>00035     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;truePdgCode&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a09299896a368002a33abc302a2bbd66f" title="The particle PDG code.">m_truePdgCode</a>);
<a name="l00036"></a>00036     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;trueMomentum&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad2492ed6ccd284b21cea54edfca4fb6a" title="The particle momentum.">m_trueMomentum</a>);
<a name="l00037"></a>00037     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;trueMatchPurity&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a8d6ec55d5e5fd4bdf8dd8e26225df9cd" title="Match purity to the true particle.">m_trueMatchPurity</a>);
<a name="l00038"></a>00038     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;trueMatchCompleteness&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ab58a03be74fa4644f7cf58df27195bcd" title="Match completeness to the true particle.">m_trueMatchCompleteness</a>);
<a name="l00039"></a>00039 
<a name="l00040"></a>00040     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;nHitsU&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a62ab19600b308e2b94b627b1f05ce242" title="The number of hits in the U view.">m_nHitsU</a>);
<a name="l00041"></a>00041     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;nHitsV&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a8668881eb81dcc684a978738c2d3b418" title="The number of hits in the U view.">m_nHitsV</a>);
<a name="l00042"></a>00042     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;nHitsW&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ac5ce240557028f5d9216c5e3c754555c" title="The number of hits in the U view.">m_nHitsW</a>);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;start&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ab15b60df9db515166da0744e13dcd5a6" title="The start position of the particle.">m_start</a>);
<a name="l00045"></a>00045     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;end&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#adc60ccea9baa957e554425420f7c2bdb" title="The end position of the particle.">m_end</a>);
<a name="l00046"></a>00046     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;startCorrected&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a70c13f6201b876b585fdacc938d96648" title="The SCE corrected start position of the particle.">m_startCorrected</a>);
<a name="l00047"></a>00047     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;endCorrected&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a83caccab7a35d9caedcc3468de4c995f" title="The SCE corrected end position of the particle.">m_endCorrected</a>);
<a name="l00048"></a>00048     
<a name="l00049"></a>00049     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;length&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9ab5fd6d751ba381ea664ffbcee16264" title="The track-length.">m_length</a>);
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;trackShower&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aae44f2bd33244cc7034f111658f4e078" title="The track-shower score.">m_trackShower</a>);
<a name="l00052"></a>00052     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;mipFraction&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad8f74bfcdbaca38108dd3be8446de80a" title="The fraction of dEdx sample points that are in the MIP region.">m_mipFraction</a>);
<a name="l00053"></a>00053     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;primaryFraction&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad9dfcfafe0b8f50d073cc83602ead059" title="The fraction of hits in the PFParticle&amp;#39;s hierarchy that are in the primary itself...">m_primaryFraction</a>);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_mu_U&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#acfa0642f78f1c7b8c37d43a121363d62" title="The chi2 under the muon hypothesis in the U view.">m_chi2_mu_U</a>);
<a name="l00056"></a>00056     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_pi_U&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aaca1c22ac36fc21f40935fdae0c408b1" title="The chi2 under the pion hypothesis in the U view.">m_chi2_pi_U</a>);
<a name="l00057"></a>00057     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_p_U&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ac83334599eb4fc01bbbe1e72ef706997" title="The chi2 under the proton hypothesis in the U view.">m_chi2_p_U</a>);
<a name="l00058"></a>00058     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_mu_V&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa0d18818a20caa3e0d697715e67d4007" title="The chi2 under the muon hypothesis in the V view.">m_chi2_mu_V</a>);
<a name="l00059"></a>00059     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_pi_V&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ae3603724a4dd68e777fa6d0292cb87e2" title="The chi2 under the pion hypothesis in the V view.">m_chi2_pi_V</a>);
<a name="l00060"></a>00060     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_p_V&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a3e600ba0b71189859762589bad70dc27" title="The chi2 under the proton hypothesis in the V view.">m_chi2_p_V</a>);
<a name="l00061"></a>00061     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_mu_W&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#af4bbfa336492af455b80ed488780c70f" title="The chi2 under the muon hypothesis in the W view.">m_chi2_mu_W</a>);
<a name="l00062"></a>00062     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_pi_W&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aeaf8c71bf93d2b1d62c5d764f60e288a" title="The chi2 under the pion hypothesis in the W view.">m_chi2_pi_W</a>);
<a name="l00063"></a>00063     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;chi2_p_W&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a2581be170ab1fcd35d9e51ce10e50cc9" title="The chi2 under the proton hypothesis in the W view.">m_chi2_p_W</a>);
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_mu_U&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#abea764bda693d8fd3115654027dcfa26" title="The forwards bragg peak likelihood under the muon hypothesis in the U view.">m_braggPeakLLH_mu_U</a>);
<a name="l00066"></a>00066     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_pi_U&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a26302090b6383bb37a288977db623443" title="The forwards bragg peak likelihood under the pion hypothesis in the U view.">m_braggPeakLLH_pi_U</a>);
<a name="l00067"></a>00067     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_p_U&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa4abb5575fd922901c664eb99a4ffcfc" title="The forwards bragg peak likelihood under the proton hypothesis in the U view.">m_braggPeakLLH_p_U</a>);
<a name="l00068"></a>00068     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_MIP_U&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ae58f53341095b57f8bdd9135f4e4a47e" title="The forwards bragg peak likelihood under the MIP hypothesis in the U view.">m_braggPeakLLH_MIP_U</a>);
<a name="l00069"></a>00069     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_mu_V&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0373048c04d4b6ca9753bd6752a79a11" title="The forwards bragg peak likelihood under the muon hypothesis in the V view.">m_braggPeakLLH_mu_V</a>);
<a name="l00070"></a>00070     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_pi_V&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a5af386909ef99b76b3c308ca2b31bf61" title="The forwards bragg peak likelihood under the pion hypothesis in the V view.">m_braggPeakLLH_pi_V</a>);
<a name="l00071"></a>00071     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_p_V&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0d3190bce46818976a23d45503f6d006" title="The forwards bragg peak likelihood under the proton hypothesis in the V view.">m_braggPeakLLH_p_V</a>);
<a name="l00072"></a>00072     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_MIP_V&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a2fc456a31a8e7bbcc86f7049ef843650" title="The forwards bragg peak likelihood under the MIP hypothesis in the V view.">m_braggPeakLLH_MIP_V</a>);
<a name="l00073"></a>00073     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_mu_W&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#af60dca445598b7fd8a7281da624c612e" title="The forwards bragg peak likelihood under the muon hypothesis in the W view.">m_braggPeakLLH_mu_W</a>);
<a name="l00074"></a>00074     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_pi_W&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a28cf0064072680d0bcbaa47863e2a884" title="The forwards bragg peak likelihood under the pion hypothesis in the W view.">m_braggPeakLLH_pi_W</a>);
<a name="l00075"></a>00075     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_p_W&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9c1499545724659d97bd06e3790ab74c" title="The forwards bragg peak likelihood under the proton hypothesis in the W view.">m_braggPeakLLH_p_W</a>);
<a name="l00076"></a>00076     <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Branch(<span class="stringliteral">&quot;braggPeakLLH_MIP_W&quot;</span>, &amp;<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a1f8ea54993d7f6175ab92d4a40ee357c" title="The forwards bragg peak likelihood under the MIP hypothesis in the W view.">m_braggPeakLLH_MIP_W</a>);
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">// -----------------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="classubcc1pi_1_1PIDStudy.html#a573fcf9fc008d970e4c9569d87d41bf1">00081</a> <span class="keywordtype">void</span> <a class="code" href="classubcc1pi_1_1PIDStudy.html#a573fcf9fc008d970e4c9569d87d41bf1" title="Analyze an event.">PIDStudy::analyze</a>(<span class="keyword">const</span> art::Event &amp;event)
<a name="l00082"></a>00082 {
<a name="l00083"></a>00083     <span class="comment">// Extract the labels</span>
<a name="l00084"></a>00084     <span class="keyword">const</span> <span class="keyword">auto</span> mcTruthLabel = <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().MCTruthLabel();
<a name="l00085"></a>00085     <span class="keyword">const</span> <span class="keyword">auto</span> mcParticleLabel = <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().MCParticleLabel();
<a name="l00086"></a>00086     <span class="keyword">const</span> <span class="keyword">auto</span> backtrackerLabel = <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().BacktrackerLabel();
<a name="l00087"></a>00087     <span class="keyword">const</span> <span class="keyword">auto</span> pfParticleLabel = <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().PFParticleLabel();
<a name="l00088"></a>00088     <span class="keyword">const</span> <span class="keyword">auto</span> trackLabel = <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().TrackLabel();
<a name="l00089"></a>00089     <span class="keyword">const</span> <span class="keyword">auto</span> pidLabel = <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().PIDLabel();
<a name="l00090"></a>00090     <span class="keyword">const</span> <span class="keyword">auto</span> calorimetryLabel = <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().CalorimetryLabel();
<a name="l00091"></a>00091     
<a name="l00092"></a>00092     <span class="comment">// Get the neutrino final state PFParticles</span>
<a name="l00093"></a>00093     <span class="keyword">const</span> <span class="keyword">auto</span> allPFParticles = CollectionHelper::GetCollection&lt;recob::PFParticle&gt;(event, pfParticleLabel);
<a name="l00094"></a>00094     <span class="keyword">const</span> <span class="keyword">auto</span> pfParticleMap = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a5844feed162067a8d9149d702df5af1c" title="Get the mapping from PFParticle.Self() -&amp;gt; PFParticle.">RecoHelper::GetPFParticleMap</a>(allPFParticles);
<a name="l00095"></a>00095     <span class="keyword">const</span> <span class="keyword">auto</span> pfParticles = <a class="code" href="classubcc1pi_1_1RecoHelper.html#af71daaff8a5ce5c4e711d60058a4424a" title="Get the PFParticles that have been deemed the neutrino final states from the PFParticle...">RecoHelper::GetNeutrinoFinalStates</a>(allPFParticles);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     <span class="comment">// Get the associations from PFParticles to metadata, tracks and PID</span>
<a name="l00098"></a>00098     <span class="keyword">const</span> <span class="keyword">auto</span> pfpToTrack = CollectionHelper::GetAssociation&lt;recob::PFParticle, recob::Track&gt;(event, pfParticleLabel, trackLabel);
<a name="l00099"></a>00099     <span class="keyword">const</span> <span class="keyword">auto</span> pfpToMetadata = CollectionHelper::GetAssociation&lt;recob::PFParticle, larpandoraobj::PFParticleMetadata&gt;(event, pfParticleLabel);
<a name="l00100"></a>00100     <span class="keyword">const</span> <span class="keyword">auto</span> pfpToHits = CollectionHelper::GetAssociationViaCollection&lt;recob::PFParticle, recob::Cluster, recob::Hit&gt;(event, pfParticleLabel, pfParticleLabel, pfParticleLabel);
<a name="l00101"></a>00101     <span class="keyword">const</span> <span class="keyword">auto</span> trackToPID = CollectionHelper::GetAssociation&lt;recob::Track, anab::ParticleID&gt;(event, trackLabel, pidLabel);
<a name="l00102"></a>00102     <span class="keyword">const</span> <span class="keyword">auto</span> trackToCalorimetry = CollectionHelper::GetAssociation&lt;recob::Track, anab::Calorimetry&gt;(event, trackLabel, calorimetryLabel);
<a name="l00103"></a>00103     
<a name="l00104"></a>00104     <span class="comment">// Get the reco-true matching information</span>
<a name="l00105"></a>00105     <span class="keyword">const</span> <span class="keyword">auto</span> backtrackerData = <a class="code" href="classubcc1pi_1_1AnalysisHelper.html#a0eecf386ca90ad73a6a7302341e8544d">AnalysisHelper::GetBacktrackerData</a>(event, mcTruthLabel, mcParticleLabel, backtrackerLabel, pfParticleLabel);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="comment">// Get the space-charge service</span>
<a name="l00108"></a>00108     <span class="keyword">const</span> <span class="keyword">auto</span> pSpaceChargeService = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a65392f76209de578e0cbc52259a48155" title="Get the space charge service for later use.">RecoHelper::GetSpaceChargeService</a>();
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="comment">// Store the event level information</span>
<a name="l00111"></a>00111     this-&gt;<a class="code" href="classubcc1pi_1_1PIDStudy.html#a9dfaa7fb7e0e40942ac5dbb3d4c186ae" title="Set the event-level information in the output branches.">SetEventInfo</a>(event, allPFParticles);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;pfParticle : pfParticles)
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115         this-&gt;<a class="code" href="classubcc1pi_1_1PIDStudy.html#ac1f55b4a8d431d67979db4ac48117275" title="Reset the particle-level info in the output branches for the next entry.">ResetParticleInfo</a>();
<a name="l00116"></a>00116         this-&gt;<a class="code" href="classubcc1pi_1_1PIDStudy.html#a30199a37ea8cc6af6270a7103de9a02e" title="Set the particle-level information about the PFParticle-&amp;gt;MCParticle matching in...">SetMatchedMCParticleInfo</a>(pfParticle, backtrackerData);
<a name="l00117"></a>00117        
<a name="l00118"></a>00118         <span class="comment">// Number of hits</span>
<a name="l00119"></a>00119         <span class="keyword">const</span> <span class="keyword">auto</span> &amp;hits = backtrackerData.GetHits(pfParticle);
<a name="l00120"></a>00120         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a62ab19600b308e2b94b627b1f05ce242" title="The number of hits in the U view.">m_nHitsU</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a998ef45cbd255ffbda91475b54261173" title="Count the number of hits in a given view.">RecoHelper::CountHitsInView</a>(hits, geo::kU);
<a name="l00121"></a>00121         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a8668881eb81dcc684a978738c2d3b418" title="The number of hits in the U view.">m_nHitsV</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a998ef45cbd255ffbda91475b54261173" title="Count the number of hits in a given view.">RecoHelper::CountHitsInView</a>(hits, geo::kV);
<a name="l00122"></a>00122         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ac5ce240557028f5d9216c5e3c754555c" title="The number of hits in the U view.">m_nHitsW</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a998ef45cbd255ffbda91475b54261173" title="Count the number of hits in a given view.">RecoHelper::CountHitsInView</a>(hits, geo::kW);
<a name="l00123"></a>00123 
<a name="l00124"></a>00124         <span class="comment">// Track-shower score </span>
<a name="l00125"></a>00125         <span class="keyword">const</span> <span class="keyword">auto</span> metadata = <a class="code" href="classubcc1pi_1_1CollectionHelper.html#aef49ea81264de87954feb660c9d6fbda" title="Get the single object associated to a given input object.">CollectionHelper::GetSingleAssociated</a>(pfParticle, pfpToMetadata);
<a name="l00126"></a>00126         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aae44f2bd33244cc7034f111658f4e078" title="The track-shower score.">m_trackShower</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#aa7b3da3945f85595dfe6385e959d0132" title="Get the track vs. shower score assigned by pandora from a metadata object.">RecoHelper::GetTrackScore</a>(metadata);
<a name="l00127"></a>00127         
<a name="l00128"></a>00128         art::Ptr&lt;recob::Track&gt; track;
<a name="l00129"></a>00129         <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classubcc1pi_1_1PIDStudy.html#abd58a231bfbcc0c11c90e82e66ac806c" title="Get the track (if any) associated with the input PFParticle.">GetTrack</a>(pfParticle, pfpToTrack, track))
<a name="l00130"></a>00130             <span class="keywordflow">continue</span>;
<a name="l00131"></a>00131    
<a name="l00132"></a>00132         <span class="comment">// Get the track start and end points, and correct them for space charge</span>
<a name="l00133"></a>00133         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ab15b60df9db515166da0744e13dcd5a6" title="The start position of the particle.">m_start</a> = TVector3(track-&gt;Start().X(), track-&gt;Start().Y(), track-&gt;Start().Z());
<a name="l00134"></a>00134         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#adc60ccea9baa957e554425420f7c2bdb" title="The end position of the particle.">m_end</a> = TVector3(track-&gt;End().X(), track-&gt;End().Y(), track-&gt;End().Z());
<a name="l00135"></a>00135         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a70c13f6201b876b585fdacc938d96648" title="The SCE corrected start position of the particle.">m_startCorrected</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a1dd5873775b95d7513df2fbd33201643" title="Correct a given position for space charge (reco -&amp;gt; true).">RecoHelper::CorrectForSpaceCharge</a>(<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ab15b60df9db515166da0744e13dcd5a6" title="The start position of the particle.">m_start</a>, pSpaceChargeService);
<a name="l00136"></a>00136         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a83caccab7a35d9caedcc3468de4c995f" title="The SCE corrected end position of the particle.">m_endCorrected</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a1dd5873775b95d7513df2fbd33201643" title="Correct a given position for space charge (reco -&amp;gt; true).">RecoHelper::CorrectForSpaceCharge</a>(<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#adc60ccea9baa957e554425420f7c2bdb" title="The end position of the particle.">m_end</a>, pSpaceChargeService);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <span class="comment">// Track length</span>
<a name="l00139"></a>00139         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9ab5fd6d751ba381ea664ffbcee16264" title="The track-length.">m_length</a> = track-&gt;Length();
<a name="l00140"></a>00140 
<a name="l00141"></a>00141         <span class="comment">/* BEGIN TEST */</span>
<a name="l00142"></a>00142         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad8f74bfcdbaca38108dd3be8446de80a" title="The fraction of dEdx sample points that are in the MIP region.">m_mipFraction</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00143"></a>00143         <span class="keyword">const</span> <span class="keyword">auto</span> calos = <a class="code" href="classubcc1pi_1_1CollectionHelper.html#a5aa35d148efb229f796a112482902a67" title="Get the objects associated to a given input object.">CollectionHelper::GetManyAssociated</a>(track, trackToCalorimetry);
<a name="l00144"></a>00144         <span class="keywordtype">float</span> nPoints = 0.f;
<a name="l00145"></a>00145         <span class="keywordtype">float</span> nMIPPoints = 0.f;
<a name="l00146"></a>00146         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;calo : calos)
<a name="l00147"></a>00147         {
<a name="l00148"></a>00148             <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;dEdx : calo-&gt;dEdx())
<a name="l00149"></a>00149             {
<a name="l00150"></a>00150                 nPoints += 1.f;
<a name="l00151"></a>00151                 <span class="keywordflow">if</span> (dEdx &lt; 2.5)
<a name="l00152"></a>00152                 {
<a name="l00153"></a>00153                     nMIPPoints += 1.f;
<a name="l00154"></a>00154                 }
<a name="l00155"></a>00155             }
<a name="l00156"></a>00156         }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158         <span class="keywordflow">if</span> (nPoints &gt;= std::numeric_limits&lt;float&gt;::epsilon())
<a name="l00159"></a>00159         {
<a name="l00160"></a>00160             <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad8f74bfcdbaca38108dd3be8446de80a" title="The fraction of dEdx sample points that are in the MIP region.">m_mipFraction</a> = nMIPPoints / nPoints;
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162         <span class="comment">/* END TEST */</span>
<a name="l00163"></a>00163 
<a name="l00164"></a>00164         <span class="comment">/* BEGIN TEST */</span>
<a name="l00165"></a>00165         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad9dfcfafe0b8f50d073cc83602ead059" title="The fraction of hits in the PFParticle&amp;#39;s hierarchy that are in the primary itself...">m_primaryFraction</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nHitsTotal = 0;
<a name="l00168"></a>00168         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;downstreamPFParticle : <a class="code" href="classubcc1pi_1_1RecoHelper.html#a8b20fe3bdcb94fd9a073312a25c77701" title="Collect all particles downstream of the input PFParticle (including the particle...">RecoHelper::GetDownstreamParticles</a>(pfParticle, pfParticleMap))
<a name="l00169"></a>00169         {
<a name="l00170"></a>00170             nHitsTotal += <a class="code" href="classubcc1pi_1_1CollectionHelper.html#a5aa35d148efb229f796a112482902a67" title="Get the objects associated to a given input object.">CollectionHelper::GetManyAssociated</a>(downstreamPFParticle, pfpToHits).size();
<a name="l00171"></a>00171         }
<a name="l00172"></a>00172         <span class="keyword">const</span> <span class="keyword">auto</span> nPrimaryHits = <a class="code" href="classubcc1pi_1_1CollectionHelper.html#a5aa35d148efb229f796a112482902a67" title="Get the objects associated to a given input object.">CollectionHelper::GetManyAssociated</a>(pfParticle, pfpToHits).size();
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         <span class="keywordflow">if</span> (nHitsTotal &gt; 0)
<a name="l00175"></a>00175         {
<a name="l00176"></a>00176             <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad9dfcfafe0b8f50d073cc83602ead059" title="The fraction of hits in the PFParticle&amp;#39;s hierarchy that are in the primary itself...">m_primaryFraction</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(nPrimaryHits) / static_cast&lt;float&gt;(nHitsTotal);
<a name="l00177"></a>00177         }
<a name="l00178"></a>00178         <span class="comment">/* END TEST */</span>
<a name="l00179"></a>00179 
<a name="l00180"></a>00180         <span class="comment">// PID algorithm outputs</span>
<a name="l00181"></a>00181         <span class="keyword">const</span> <span class="keyword">auto</span> pid = <a class="code" href="classubcc1pi_1_1CollectionHelper.html#aef49ea81264de87954feb660c9d6fbda" title="Get the single object associated to a given input object.">CollectionHelper::GetSingleAssociated</a>(track, trackToPID);
<a name="l00182"></a>00182         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;algo : pid-&gt;ParticleIDAlgScores())
<a name="l00183"></a>00183         {
<a name="l00184"></a>00184             <span class="keyword">const</span> <span class="keyword">auto</span> view = this-&gt;<a class="code" href="classubcc1pi_1_1PIDStudy.html#a02332b2cff6beec99843ede2afdc4338" title="Convert the plane mask from the PID module to a view.">GetView</a>(algo.fPlaneMask);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186             <span class="comment">// Chi2 algorithms</span>
<a name="l00187"></a>00187             <span class="keywordflow">if</span> (algo.fAlgName == <span class="stringliteral">&quot;Chi2&quot;</span>)
<a name="l00188"></a>00188             {
<a name="l00189"></a>00189                 <span class="keywordflow">switch</span> (algo.fAssumedPdg)
<a name="l00190"></a>00190                 {
<a name="l00191"></a>00191                     <span class="keywordflow">case</span> 13:
<a name="l00192"></a>00192                         <span class="keywordflow">switch</span> (view)
<a name="l00193"></a>00193                         {
<a name="l00194"></a>00194                             <span class="keywordflow">case</span> geo::kW:
<a name="l00195"></a>00195                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#af4bbfa336492af455b80ed488780c70f" title="The chi2 under the muon hypothesis in the W view.">m_chi2_mu_W</a> = algo.fValue;
<a name="l00196"></a>00196                                 <span class="keywordflow">break</span>;
<a name="l00197"></a>00197                             <span class="keywordflow">case</span> geo::kU:
<a name="l00198"></a>00198                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#acfa0642f78f1c7b8c37d43a121363d62" title="The chi2 under the muon hypothesis in the U view.">m_chi2_mu_U</a> = algo.fValue;
<a name="l00199"></a>00199                                 <span class="keywordflow">break</span>;
<a name="l00200"></a>00200                             <span class="keywordflow">case</span> geo::kV:
<a name="l00201"></a>00201                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa0d18818a20caa3e0d697715e67d4007" title="The chi2 under the muon hypothesis in the V view.">m_chi2_mu_V</a> = algo.fValue;
<a name="l00202"></a>00202                                 <span class="keywordflow">break</span>;
<a name="l00203"></a>00203                             <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00204"></a>00204                         }
<a name="l00205"></a>00205                         <span class="keywordflow">break</span>;
<a name="l00206"></a>00206                     <span class="keywordflow">case</span> 211:
<a name="l00207"></a>00207                         <span class="keywordflow">switch</span> (view)
<a name="l00208"></a>00208                         {
<a name="l00209"></a>00209                             <span class="keywordflow">case</span> geo::kW:
<a name="l00210"></a>00210                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aeaf8c71bf93d2b1d62c5d764f60e288a" title="The chi2 under the pion hypothesis in the W view.">m_chi2_pi_W</a> = algo.fValue;
<a name="l00211"></a>00211                                 <span class="keywordflow">break</span>;
<a name="l00212"></a>00212                             <span class="keywordflow">case</span> geo::kU:
<a name="l00213"></a>00213                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aaca1c22ac36fc21f40935fdae0c408b1" title="The chi2 under the pion hypothesis in the U view.">m_chi2_pi_U</a> = algo.fValue;
<a name="l00214"></a>00214                                 <span class="keywordflow">break</span>;
<a name="l00215"></a>00215                             <span class="keywordflow">case</span> geo::kV:
<a name="l00216"></a>00216                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ae3603724a4dd68e777fa6d0292cb87e2" title="The chi2 under the pion hypothesis in the V view.">m_chi2_pi_V</a> = algo.fValue;
<a name="l00217"></a>00217                                 <span class="keywordflow">break</span>;
<a name="l00218"></a>00218                             <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00219"></a>00219                         }
<a name="l00220"></a>00220                         <span class="keywordflow">break</span>;
<a name="l00221"></a>00221                     <span class="keywordflow">case</span> 2212:
<a name="l00222"></a>00222                         <span class="keywordflow">switch</span> (view)
<a name="l00223"></a>00223                         {
<a name="l00224"></a>00224                             <span class="keywordflow">case</span> geo::kW:
<a name="l00225"></a>00225                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a2581be170ab1fcd35d9e51ce10e50cc9" title="The chi2 under the proton hypothesis in the W view.">m_chi2_p_W</a> = algo.fValue;
<a name="l00226"></a>00226                                 <span class="keywordflow">break</span>;
<a name="l00227"></a>00227                             <span class="keywordflow">case</span> geo::kU:
<a name="l00228"></a>00228                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ac83334599eb4fc01bbbe1e72ef706997" title="The chi2 under the proton hypothesis in the U view.">m_chi2_p_U</a> = algo.fValue;
<a name="l00229"></a>00229                                 <span class="keywordflow">break</span>;
<a name="l00230"></a>00230                             <span class="keywordflow">case</span> geo::kV:
<a name="l00231"></a>00231                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a3e600ba0b71189859762589bad70dc27" title="The chi2 under the proton hypothesis in the V view.">m_chi2_p_V</a> = algo.fValue;
<a name="l00232"></a>00232                                 <span class="keywordflow">break</span>;
<a name="l00233"></a>00233                             <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00234"></a>00234                         }
<a name="l00235"></a>00235                         <span class="keywordflow">break</span>;
<a name="l00236"></a>00236                     <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00237"></a>00237                 }
<a name="l00238"></a>00238             }
<a name="l00239"></a>00239             
<a name="l00240"></a>00240             <span class="comment">// Bragg peak algorithms</span>
<a name="l00241"></a>00241             <span class="keywordflow">if</span> (algo.fAlgName == <span class="stringliteral">&quot;BraggPeakLLH&quot;</span> &amp;&amp; algo.fTrackDir == anab::kForward)
<a name="l00242"></a>00242             {
<a name="l00243"></a>00243                 <span class="keywordflow">switch</span> (algo.fAssumedPdg)
<a name="l00244"></a>00244                 {
<a name="l00245"></a>00245                     <span class="keywordflow">case</span> 13:
<a name="l00246"></a>00246                         <span class="keywordflow">switch</span> (view)
<a name="l00247"></a>00247                         {
<a name="l00248"></a>00248                             <span class="keywordflow">case</span> geo::kW:
<a name="l00249"></a>00249                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#af60dca445598b7fd8a7281da624c612e" title="The forwards bragg peak likelihood under the muon hypothesis in the W view.">m_braggPeakLLH_mu_W</a> = algo.fValue;
<a name="l00250"></a>00250                                 <span class="keywordflow">break</span>;
<a name="l00251"></a>00251                             <span class="keywordflow">case</span> geo::kU:
<a name="l00252"></a>00252                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#abea764bda693d8fd3115654027dcfa26" title="The forwards bragg peak likelihood under the muon hypothesis in the U view.">m_braggPeakLLH_mu_U</a> = algo.fValue;
<a name="l00253"></a>00253                                 <span class="keywordflow">break</span>;
<a name="l00254"></a>00254                             <span class="keywordflow">case</span> geo::kV:
<a name="l00255"></a>00255                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0373048c04d4b6ca9753bd6752a79a11" title="The forwards bragg peak likelihood under the muon hypothesis in the V view.">m_braggPeakLLH_mu_V</a> = algo.fValue;
<a name="l00256"></a>00256                                 <span class="keywordflow">break</span>;
<a name="l00257"></a>00257                             <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00258"></a>00258                         }
<a name="l00259"></a>00259                         <span class="keywordflow">break</span>;
<a name="l00260"></a>00260                     <span class="keywordflow">case</span> 211:
<a name="l00261"></a>00261                         <span class="keywordflow">switch</span> (view)
<a name="l00262"></a>00262                         {
<a name="l00263"></a>00263                             <span class="keywordflow">case</span> geo::kW:
<a name="l00264"></a>00264                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a28cf0064072680d0bcbaa47863e2a884" title="The forwards bragg peak likelihood under the pion hypothesis in the W view.">m_braggPeakLLH_pi_W</a> = algo.fValue;
<a name="l00265"></a>00265                                 <span class="keywordflow">break</span>;
<a name="l00266"></a>00266                             <span class="keywordflow">case</span> geo::kU:
<a name="l00267"></a>00267                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a26302090b6383bb37a288977db623443" title="The forwards bragg peak likelihood under the pion hypothesis in the U view.">m_braggPeakLLH_pi_U</a> = algo.fValue;
<a name="l00268"></a>00268                                 <span class="keywordflow">break</span>;
<a name="l00269"></a>00269                             <span class="keywordflow">case</span> geo::kV:
<a name="l00270"></a>00270                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a5af386909ef99b76b3c308ca2b31bf61" title="The forwards bragg peak likelihood under the pion hypothesis in the V view.">m_braggPeakLLH_pi_V</a> = algo.fValue;
<a name="l00271"></a>00271                                 <span class="keywordflow">break</span>;
<a name="l00272"></a>00272                             <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00273"></a>00273                         }
<a name="l00274"></a>00274                         <span class="keywordflow">break</span>;
<a name="l00275"></a>00275                     <span class="keywordflow">case</span> 2212:
<a name="l00276"></a>00276                         <span class="keywordflow">switch</span> (view)
<a name="l00277"></a>00277                         {
<a name="l00278"></a>00278                             <span class="keywordflow">case</span> geo::kW:
<a name="l00279"></a>00279                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9c1499545724659d97bd06e3790ab74c" title="The forwards bragg peak likelihood under the proton hypothesis in the W view.">m_braggPeakLLH_p_W</a> = algo.fValue;
<a name="l00280"></a>00280                                 <span class="keywordflow">break</span>;
<a name="l00281"></a>00281                             <span class="keywordflow">case</span> geo::kU:
<a name="l00282"></a>00282                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa4abb5575fd922901c664eb99a4ffcfc" title="The forwards bragg peak likelihood under the proton hypothesis in the U view.">m_braggPeakLLH_p_U</a> = algo.fValue;
<a name="l00283"></a>00283                                 <span class="keywordflow">break</span>;
<a name="l00284"></a>00284                             <span class="keywordflow">case</span> geo::kV:
<a name="l00285"></a>00285                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0d3190bce46818976a23d45503f6d006" title="The forwards bragg peak likelihood under the proton hypothesis in the V view.">m_braggPeakLLH_p_V</a> = algo.fValue;
<a name="l00286"></a>00286                                 <span class="keywordflow">break</span>;
<a name="l00287"></a>00287                             <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00288"></a>00288                         }
<a name="l00289"></a>00289                         <span class="keywordflow">break</span>;
<a name="l00290"></a>00290                     <span class="keywordflow">case</span> 0:
<a name="l00291"></a>00291                         <span class="keywordflow">switch</span> (view)
<a name="l00292"></a>00292                         {
<a name="l00293"></a>00293                             <span class="keywordflow">case</span> geo::kW:
<a name="l00294"></a>00294                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a1f8ea54993d7f6175ab92d4a40ee357c" title="The forwards bragg peak likelihood under the MIP hypothesis in the W view.">m_braggPeakLLH_MIP_W</a> = algo.fValue;
<a name="l00295"></a>00295                                 <span class="keywordflow">break</span>;
<a name="l00296"></a>00296                             <span class="keywordflow">case</span> geo::kU:
<a name="l00297"></a>00297                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ae58f53341095b57f8bdd9135f4e4a47e" title="The forwards bragg peak likelihood under the MIP hypothesis in the U view.">m_braggPeakLLH_MIP_U</a> = algo.fValue;
<a name="l00298"></a>00298                                 <span class="keywordflow">break</span>;
<a name="l00299"></a>00299                             <span class="keywordflow">case</span> geo::kV:
<a name="l00300"></a>00300                                 <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a2fc456a31a8e7bbcc86f7049ef843650" title="The forwards bragg peak likelihood under the MIP hypothesis in the V view.">m_braggPeakLLH_MIP_V</a> = algo.fValue;
<a name="l00301"></a>00301                                 <span class="keywordflow">break</span>;
<a name="l00302"></a>00302                             <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00303"></a>00303                         }
<a name="l00304"></a>00304                         <span class="keywordflow">break</span>;
<a name="l00305"></a>00305                     <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;
<a name="l00306"></a>00306                 }
<a name="l00307"></a>00307             }
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309         
<a name="l00310"></a>00310         <a class="code" href="classubcc1pi_1_1PIDStudy.html#a864ee800ea168d6bb1fbf68552f1b635" title="The output tree for all particle level data.">m_pParticleTree</a>-&gt;Fill();
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="comment">// -----------------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="classubcc1pi_1_1PIDStudy.html#a9dfaa7fb7e0e40942ac5dbb3d4c186ae">00316</a> <span class="keywordtype">void</span> <a class="code" href="classubcc1pi_1_1PIDStudy.html#a9dfaa7fb7e0e40942ac5dbb3d4c186ae" title="Set the event-level information in the output branches.">PIDStudy::SetEventInfo</a>(<span class="keyword">const</span> art::Event &amp;event, <span class="keyword">const</span> <a class="code" href="namespaceubcc1pi.html#a6f66dc13c5a55147db5c84db67f6062b" title="A collection of PFParticles.">PFParticleVector</a> &amp;allPFParticles)
<a name="l00317"></a>00317 {    
<a name="l00318"></a>00318     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a6bc123c7fb3491a9acc47eb31b540efd" title="The run number.">m_run</a> = <span class="keyword">event</span>.run();
<a name="l00319"></a>00319     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa1b8e87ea34a539940d6f3ff7bfb2cb6" title="The subrun number.">m_subRun</a> = <span class="keyword">event</span>.subRun();
<a name="l00320"></a>00320     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9d62271c5389b4c09caedafb401e7855" title="The event number.">m_event</a> = <span class="keyword">event</span>.event();
<a name="l00321"></a>00321     
<a name="l00322"></a>00322     <span class="keyword">const</span> <a class="code" href="classubcc1pi_1_1TruthHelper_1_1Interaction.html" title="The interaction class - represents a neutrino interaction.">TruthHelper::Interaction</a> interaction(event, <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().MCTruthLabel(), <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().MCParticleLabel());
<a name="l00323"></a>00323     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0759361e64f5737cbaf3754a5ea2a077" title="If the event is a true CC1Pi signal.">m_isSignal</a> = <a class="code" href="classubcc1pi_1_1AnalysisHelper.html#adfe9e4f5eff1afaa590aa6cc90406f4d">AnalysisHelper::IsCC1PiSignal</a>(interaction);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a00a4c0afbb17b462c59115391503f13e" title="The reconstructed neutrino vertex.">m_nuVertex</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a8df80cd3aa9c3d29113f9049ce1067cc" title="Get the reconstructed neutrino interaction vertex position.">RecoHelper::GetRecoNeutrinoVertex</a>(event, allPFParticles, <a class="code" href="classubcc1pi_1_1PIDStudy.html#ab769f2814b6897cb753bd5ba58bad0e4" title="The FHiCL configuration options.">m_config</a>().PFParticleLabel());
<a name="l00326"></a>00326     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a79502eb5a7d31bda894915a2389c949e" title="The SCE corrected reconstructed neutrino vertex.">m_nuVertexCorrected</a> = <a class="code" href="classubcc1pi_1_1RecoHelper.html#a1dd5873775b95d7513df2fbd33201643" title="Correct a given position for space charge (reco -&amp;gt; true).">RecoHelper::CorrectForSpaceCharge</a>(<a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a00a4c0afbb17b462c59115391503f13e" title="The reconstructed neutrino vertex.">m_nuVertex</a>, <a class="code" href="classubcc1pi_1_1RecoHelper.html#a65392f76209de578e0cbc52259a48155" title="Get the space charge service for later use.">RecoHelper::GetSpaceChargeService</a>());
<a name="l00327"></a>00327 }
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 <span class="comment">// -----------------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="classubcc1pi_1_1PIDStudy.html#ac1f55b4a8d431d67979db4ac48117275">00331</a> <span class="keywordtype">void</span> <a class="code" href="classubcc1pi_1_1PIDStudy.html#ac1f55b4a8d431d67979db4ac48117275" title="Reset the particle-level info in the output branches for the next entry.">PIDStudy::ResetParticleInfo</a>()
<a name="l00332"></a>00332 {
<a name="l00333"></a>00333     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa605da52b26e7200891698c4d858a5d1" title="If the PFParticle matches to any neutrino MCParticles.">m_hasMatchedMCParticle</a> = <span class="keyword">false</span>;
<a name="l00334"></a>00334     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a09299896a368002a33abc302a2bbd66f" title="The particle PDG code.">m_truePdgCode</a> = -std::numeric_limits&lt;int&gt;::max();
<a name="l00335"></a>00335     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad2492ed6ccd284b21cea54edfca4fb6a" title="The particle momentum.">m_trueMomentum</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00336"></a>00336     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a8d6ec55d5e5fd4bdf8dd8e26225df9cd" title="Match purity to the true particle.">m_trueMatchPurity</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00337"></a>00337     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ab58a03be74fa4644f7cf58df27195bcd" title="Match completeness to the true particle.">m_trueMatchCompleteness</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00338"></a>00338     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a62ab19600b308e2b94b627b1f05ce242" title="The number of hits in the U view.">m_nHitsU</a> = -std::numeric_limits&lt;int&gt;::max();
<a name="l00339"></a>00339     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a8668881eb81dcc684a978738c2d3b418" title="The number of hits in the U view.">m_nHitsV</a> = -std::numeric_limits&lt;int&gt;::max();
<a name="l00340"></a>00340     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ac5ce240557028f5d9216c5e3c754555c" title="The number of hits in the U view.">m_nHitsW</a> = -std::numeric_limits&lt;int&gt;::max();
<a name="l00341"></a>00341     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9ab5fd6d751ba381ea664ffbcee16264" title="The track-length.">m_length</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00342"></a>00342     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aae44f2bd33244cc7034f111658f4e078" title="The track-shower score.">m_trackShower</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00343"></a>00343     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#acfa0642f78f1c7b8c37d43a121363d62" title="The chi2 under the muon hypothesis in the U view.">m_chi2_mu_U</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00344"></a>00344     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aaca1c22ac36fc21f40935fdae0c408b1" title="The chi2 under the pion hypothesis in the U view.">m_chi2_pi_U</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00345"></a>00345     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ac83334599eb4fc01bbbe1e72ef706997" title="The chi2 under the proton hypothesis in the U view.">m_chi2_p_U</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00346"></a>00346     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa0d18818a20caa3e0d697715e67d4007" title="The chi2 under the muon hypothesis in the V view.">m_chi2_mu_V</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00347"></a>00347     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ae3603724a4dd68e777fa6d0292cb87e2" title="The chi2 under the pion hypothesis in the V view.">m_chi2_pi_V</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00348"></a>00348     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a3e600ba0b71189859762589bad70dc27" title="The chi2 under the proton hypothesis in the V view.">m_chi2_p_V</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00349"></a>00349     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#af4bbfa336492af455b80ed488780c70f" title="The chi2 under the muon hypothesis in the W view.">m_chi2_mu_W</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00350"></a>00350     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aeaf8c71bf93d2b1d62c5d764f60e288a" title="The chi2 under the pion hypothesis in the W view.">m_chi2_pi_W</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00351"></a>00351     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a2581be170ab1fcd35d9e51ce10e50cc9" title="The chi2 under the proton hypothesis in the W view.">m_chi2_p_W</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00352"></a>00352     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#abea764bda693d8fd3115654027dcfa26" title="The forwards bragg peak likelihood under the muon hypothesis in the U view.">m_braggPeakLLH_mu_U</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00353"></a>00353     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a26302090b6383bb37a288977db623443" title="The forwards bragg peak likelihood under the pion hypothesis in the U view.">m_braggPeakLLH_pi_U</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00354"></a>00354     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa4abb5575fd922901c664eb99a4ffcfc" title="The forwards bragg peak likelihood under the proton hypothesis in the U view.">m_braggPeakLLH_p_U</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00355"></a>00355     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ae58f53341095b57f8bdd9135f4e4a47e" title="The forwards bragg peak likelihood under the MIP hypothesis in the U view.">m_braggPeakLLH_MIP_U</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00356"></a>00356     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0373048c04d4b6ca9753bd6752a79a11" title="The forwards bragg peak likelihood under the muon hypothesis in the V view.">m_braggPeakLLH_mu_V</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00357"></a>00357     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a5af386909ef99b76b3c308ca2b31bf61" title="The forwards bragg peak likelihood under the pion hypothesis in the V view.">m_braggPeakLLH_pi_V</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00358"></a>00358     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a0d3190bce46818976a23d45503f6d006" title="The forwards bragg peak likelihood under the proton hypothesis in the V view.">m_braggPeakLLH_p_V</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00359"></a>00359     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a2fc456a31a8e7bbcc86f7049ef843650" title="The forwards bragg peak likelihood under the MIP hypothesis in the V view.">m_braggPeakLLH_MIP_V</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00360"></a>00360     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#af60dca445598b7fd8a7281da624c612e" title="The forwards bragg peak likelihood under the muon hypothesis in the W view.">m_braggPeakLLH_mu_W</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00361"></a>00361     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a28cf0064072680d0bcbaa47863e2a884" title="The forwards bragg peak likelihood under the pion hypothesis in the W view.">m_braggPeakLLH_pi_W</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00362"></a>00362     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a9c1499545724659d97bd06e3790ab74c" title="The forwards bragg peak likelihood under the proton hypothesis in the W view.">m_braggPeakLLH_p_W</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00363"></a>00363     <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a1f8ea54993d7f6175ab92d4a40ee357c" title="The forwards bragg peak likelihood under the MIP hypothesis in the W view.">m_braggPeakLLH_MIP_W</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00364"></a>00364 }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="comment">// -----------------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00367"></a>00367 
<a name="l00368"></a><a class="code" href="classubcc1pi_1_1PIDStudy.html#a30199a37ea8cc6af6270a7103de9a02e">00368</a> <span class="keywordtype">void</span> <a class="code" href="classubcc1pi_1_1PIDStudy.html#a30199a37ea8cc6af6270a7103de9a02e" title="Set the particle-level information about the PFParticle-&amp;gt;MCParticle matching in...">PIDStudy::SetMatchedMCParticleInfo</a>(<span class="keyword">const</span> art::Ptr&lt;recob::PFParticle&gt; &amp;pfParticle, <span class="keyword">const</span> <a class="code" href="classubcc1pi_1_1BacktrackHelper_1_1BacktrackerData.html" title="Class holding backtracking data.">BacktrackHelper::BacktrackerData</a> &amp;backtrackerData)
<a name="l00369"></a>00369 {
<a name="l00370"></a>00370     <span class="keywordflow">try</span>
<a name="l00371"></a>00371     {
<a name="l00372"></a>00372         <span class="keyword">const</span> <span class="keyword">auto</span> mcParticle = backtrackerData.<a class="code" href="classubcc1pi_1_1BacktrackHelper_1_1BacktrackerData.html#a278df2088e0b86a416da69c7f8f8ee97" title="Get the MCParticle with the highest weighted match to the given PFParticle.">GetBestMatchedMCParticle</a>(pfParticle);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a09299896a368002a33abc302a2bbd66f" title="The particle PDG code.">m_truePdgCode</a> = mcParticle-&gt;PdgCode();
<a name="l00375"></a>00375         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad2492ed6ccd284b21cea54edfca4fb6a" title="The particle momentum.">m_trueMomentum</a> = mcParticle-&gt;P();
<a name="l00376"></a>00376         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a8d6ec55d5e5fd4bdf8dd8e26225df9cd" title="Match purity to the true particle.">m_trueMatchPurity</a> = backtrackerData.<a class="code" href="classubcc1pi_1_1BacktrackHelper_1_1BacktrackerData.html#a8f5fa5a741e52e1549fb4dd67213de88" title="Get the purity of a given PFParticle-MCParticle pair = shared weight / PFParticle...">GetMatchPurity</a>(pfParticle, mcParticle);
<a name="l00377"></a>00377         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ab58a03be74fa4644f7cf58df27195bcd" title="Match completeness to the true particle.">m_trueMatchCompleteness</a> = backtrackerData.<a class="code" href="classubcc1pi_1_1BacktrackHelper_1_1BacktrackerData.html#a5d62542a22cb2d0f17795c03ca0b7c6e" title="Get the completeness a given PFParticle-MCParticle pair = shared weight / MCParticle...">GetMatchCompleteness</a>(pfParticle, mcParticle);
<a name="l00378"></a>00378         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa605da52b26e7200891698c4d858a5d1" title="If the PFParticle matches to any neutrino MCParticles.">m_hasMatchedMCParticle</a> = <span class="keyword">true</span>;
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380     <span class="keywordflow">catch</span> (<span class="keyword">const</span> cet::exception &amp;)
<a name="l00381"></a>00381     {
<a name="l00382"></a>00382         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a09299896a368002a33abc302a2bbd66f" title="The particle PDG code.">m_truePdgCode</a> = -std::numeric_limits&lt;int&gt;::max();
<a name="l00383"></a>00383         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ad2492ed6ccd284b21cea54edfca4fb6a" title="The particle momentum.">m_trueMomentum</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00384"></a>00384         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#a8d6ec55d5e5fd4bdf8dd8e26225df9cd" title="Match purity to the true particle.">m_trueMatchPurity</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00385"></a>00385         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#ab58a03be74fa4644f7cf58df27195bcd" title="Match completeness to the true particle.">m_trueMatchCompleteness</a> = -std::numeric_limits&lt;float&gt;::max();
<a name="l00386"></a>00386         <a class="code" href="classubcc1pi_1_1PIDStudy.html#aa8a43cfc0670911c57482cfc3d19b93f" title="The output particle-level object.">m_outputParticle</a>.<a class="code" href="structubcc1pi_1_1PIDStudy_1_1OutputParticle.html#aa605da52b26e7200891698c4d858a5d1" title="If the PFParticle matches to any neutrino MCParticles.">m_hasMatchedMCParticle</a> = <span class="keyword">false</span>;
<a name="l00387"></a>00387     }
<a name="l00388"></a>00388 }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 <span class="comment">// -----------------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00391"></a>00391     
<a name="l00392"></a><a class="code" href="classubcc1pi_1_1PIDStudy.html#abd58a231bfbcc0c11c90e82e66ac806c">00392</a> <span class="keywordtype">bool</span> <a class="code" href="classubcc1pi_1_1PIDStudy.html#abd58a231bfbcc0c11c90e82e66ac806c" title="Get the track (if any) associated with the input PFParticle.">PIDStudy::GetTrack</a>(<span class="keyword">const</span> art::Ptr&lt;recob::PFParticle&gt; &amp;pfParticle, <span class="keyword">const</span> Association&lt;recob::PFParticle, recob::Track&gt; &amp;pfpToTrack, art::Ptr&lt;recob::Track&gt; &amp;track)
<a name="l00393"></a>00393 {
<a name="l00394"></a>00394     <span class="keywordflow">try</span>
<a name="l00395"></a>00395     {
<a name="l00396"></a>00396         <span class="keyword">const</span> <span class="keyword">auto</span> tracks = <a class="code" href="classubcc1pi_1_1CollectionHelper.html#a5aa35d148efb229f796a112482902a67" title="Get the objects associated to a given input object.">CollectionHelper::GetManyAssociated</a>(pfParticle, pfpToTrack); 
<a name="l00397"></a>00397         
<a name="l00398"></a>00398         <span class="keywordflow">if</span> (tracks.empty())
<a name="l00399"></a>00399             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401         <span class="keywordflow">if</span> (tracks.size() &gt; 1)
<a name="l00402"></a>00402             <span class="keywordflow">throw</span> cet::exception(<span class="stringliteral">&quot;PIDStudy::GetTrack&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; - Multiple tracks associated to PFParticle!&quot;</span> &lt;&lt; std::endl;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404         track = tracks.front();
<a name="l00405"></a>00405         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00406"></a>00406     }
<a name="l00407"></a>00407     <span class="keywordflow">catch</span> (<span class="keyword">const</span> cet::exception &amp;)
<a name="l00408"></a>00408     {
<a name="l00409"></a>00409         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411 }       
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="comment">// -----------------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00414"></a>00414 
<a name="l00415"></a><a class="code" href="classubcc1pi_1_1PIDStudy.html#a02332b2cff6beec99843ede2afdc4338">00415</a> geo::View_t <a class="code" href="classubcc1pi_1_1PIDStudy.html#a02332b2cff6beec99843ede2afdc4338" title="Convert the plane mask from the PID module to a view.">PIDStudy::GetView</a>(<span class="keyword">const</span> std::bitset&lt;8&gt; &amp;planeMask)<span class="keyword"> const</span>
<a name="l00416"></a>00416 <span class="keyword"></span>{
<a name="l00417"></a>00417     <span class="comment">// Here is a hack to get around a bug in the PID code. Some algorithms call W = 0, U = 1, V = 2. But others call W = 7, U = 6, V = 5</span>
<a name="l00418"></a>00418     <span class="keyword">const</span> <span class="keywordtype">bool</span> usesW = planeMask.test(0) || planeMask.test(7);
<a name="l00419"></a>00419     <span class="keyword">const</span> <span class="keywordtype">bool</span> usesU = planeMask.test(1) || planeMask.test(6);
<a name="l00420"></a>00420     <span class="keyword">const</span> <span class="keywordtype">bool</span> usesV = planeMask.test(2) || planeMask.test(5);
<a name="l00421"></a>00421     
<a name="l00422"></a>00422     <span class="keywordflow">if</span> (usesW &amp;&amp; !usesU &amp;&amp; !usesV)
<a name="l00423"></a>00423         <span class="keywordflow">return</span> geo::kW;
<a name="l00424"></a>00424     
<a name="l00425"></a>00425     <span class="keywordflow">if</span> (!usesW &amp;&amp; usesU &amp;&amp; !usesV)
<a name="l00426"></a>00426         <span class="keywordflow">return</span> geo::kU;
<a name="l00427"></a>00427     
<a name="l00428"></a>00428     <span class="keywordflow">if</span> (!usesW &amp;&amp; !usesU &amp;&amp; usesV)
<a name="l00429"></a>00429         <span class="keywordflow">return</span> geo::kV;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <span class="keywordflow">return</span> geo::kUnknown;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 } <span class="comment">// namespace ubcc1pi</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/>
<address style="text-align: right;">
    <small>
        Generated on Wed Jul 3 11:57:59 2019 for ubcc1pi by <a href="http://www.doxygen.org/index.html" target="_blank">doxygen</a> 1.6.1
    </small>
</address>

</section>

</body>
</html>
